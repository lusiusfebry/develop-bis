generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Enum Definitions
enum StatusMaster {
  Aktif
  TidakAktif
}

enum RoleUser {
  Administrator
  HR
  Karyawan
}

enum JenisKelamin {
  LakiLaki
  Perempuan
}

enum Agama {
  Islam
  Kristen
  Katolik
  Hindu
  Buddha
  Konghucu
}

enum GolonganDarah {
  A
  B
  AB
  O
}

enum StatusPernikahan {
  BelumMenikah
  Menikah
  Cerai
  CeraiMati
}

enum StatusKelulusan {
  Lulus
  TidakLulus
  SedangBerjalan
}

model User {
  id            String   @id @default(uuid())
  nik           String   @unique
  password_hash String
  role          RoleUser @default(Karyawan)
  karyawan_id   String?  @unique
  created_at    DateTime @default(now())
  updated_at    DateTime @updatedAt

  karyawan Karyawan? @relation(fields: [karyawan_id], references: [id])

  @@map("users")
}

// Master Data Models
model Divisi {
  id           String       @id @default(uuid())
  nama_divisi  String       @unique
  status       StatusMaster @default(Aktif)
  keterangan   String?
  created_at   DateTime     @default(now())
  updated_at   DateTime     @updatedAt
  department   Department[]
  karyawan     Karyawan[]

  @@map("divisi")
}

model Department {
  id              String         @id @default(uuid())
  nama_department String       @unique
  divisi_id       String
  status          StatusMaster   @default(Aktif)
  keterangan      String?
  created_at      DateTime       @default(now())
  updated_at      DateTime       @updatedAt
  divisi          Divisi         @relation(fields: [divisi_id], references: [id])
  posisi_jabatan  PosisiJabatan[]
  karyawan        Karyawan[]

  @@map("department")
}

model PosisiJabatan {
  id                  String       @id @default(uuid())
  nama_posisi_jabatan String       @unique
  department_id       String
  status              StatusMaster @default(Aktif)
  keterangan          String?
  created_at          DateTime     @default(now())
  updated_at          DateTime     @updatedAt
  department          Department   @relation(fields: [department_id], references: [id])
  karyawan            Karyawan[]

  @@map("posisi_jabatan")
}

model KategoriPangkat {
  id                    String       @id @default(uuid())
  nama_kategori_pangkat String       @unique
  status                StatusMaster @default(Aktif)
  keterangan            String?
  created_at            DateTime     @default(now())
  updated_at            DateTime     @updatedAt
  karyawan              Karyawan[]

  @@map("kategori_pangkat")
}

model Golongan {
  id            String       @id @default(uuid())
  nama_golongan String       @unique
  status        StatusMaster @default(Aktif)
  keterangan    String?
  created_at    DateTime     @default(now())
  updated_at    DateTime     @updatedAt
  karyawan      Karyawan[]

  @@map("golongan")
}

model SubGolongan {
  id                String       @id @default(uuid())
  nama_sub_golongan String       @unique
  status            StatusMaster @default(Aktif)
  keterangan        String?
  created_at        DateTime     @default(now())
  updated_at        DateTime     @updatedAt
  karyawan          Karyawan[]

  @@map("sub_golongan")
}

model JenisHubunganKerja {
  id                       String       @id @default(uuid())
  nama_jenis_hubungan_kerja String       @unique
  status                   StatusMaster @default(Aktif)
  keterangan               String?
  created_at               DateTime     @default(now())
  updated_at               DateTime     @updatedAt
  karyawan                 Karyawan[]

  @@map("jenis_hubungan_kerja")
}

model Tag {
  id        String       @id @default(uuid())
  nama_tag  String       @unique
  warna_tag String?
  status    StatusMaster @default(Aktif)
  keterangan String?
  created_at DateTime     @default(now())
  updated_at DateTime     @updatedAt
  karyawan  Karyawan[]

  @@map("tag")
}

model LokasiKerja {
  id                String       @id @default(uuid())
  nama_lokasi_kerja String       @unique
  alamat            String?
  status            StatusMaster @default(Aktif)
  keterangan        String?
  created_at        DateTime     @default(now())
  updated_at        DateTime     @updatedAt
  karyawan_lokasi   Karyawan[]   @relation("LokasiKerja")
  karyawan_sebelumnya Karyawan[] @relation("LokasiSebelumnya")

  @@map("lokasi_kerja")
}

model StatusKaryawan {
  id          String       @id @default(uuid())
  nama_status String       @unique
  status      StatusMaster @default(Aktif)
  keterangan  String?
  created_at  DateTime     @default(now())
  updated_at  DateTime     @updatedAt
  karyawan    Karyawan[]

  @@map("status_karyawan")
}

model Karyawan {
  // Bagian Head
  id                   String   @id @default(uuid())
  foto_karyawan        String?
  nama_lengkap         String
  nomor_induk_karyawan String   @unique
  divisi_id            String
  department_id        String
  posisi_jabatan_id    String
  manager_id           String?
  atasan_langsung_id   String?
  email_perusahaan     String?
  nomor_handphone      String?
  status_karyawan_id   String
  lokasi_kerja_id      String
  tag_id              String?

  // Tab Personal Information
  jenis_kelamin        JenisKelamin?
  tempat_lahir         String?
  tanggal_lahir        DateTime?
  email_pribadi        String?
  agama                Agama?
  golongan_darah       GolonganDarah?
  nomor_kartu_keluarga String?
  nomor_ktp            String?
  nomor_npwp           String?
  nomor_bpjs           String?
  no_nik_kk            String?
  status_pajak         String?
  alamat_domisili      String?
  kota_domisili        String?
  provinsi_domisili    String?
  alamat_ktp           String?
  kota_ktp             String?
  provinsi_ktp         String?
  nomor_handphone_2    String?
  nomor_telepon_rumah_1 String?
  nomor_telepon_rumah_2 String?
  status_pernikahan    StatusPernikahan?
  nama_pasangan        String?
  tanggal_menikah      DateTime?
  tanggal_cerai        DateTime?
  tanggal_wafat_pasangan DateTime?
  pekerjaan_pasangan   String?
  jumlah_anak          Int?
  nomor_rekening       String?
  nama_pemegang_rekening String?
  nama_bank            String?
  cabang_bank          String?

  // Tab Informasi HR
  jenis_hubungan_kerja_id    String?
  tanggal_masuk_group        DateTime?
  tanggal_masuk              DateTime?
  tanggal_permanent          DateTime?
  tanggal_kontrak            DateTime?
  tanggal_akhir_kontrak      DateTime?
  tanggal_berhenti           DateTime?
  tingkat_pendidikan         String?
  bidang_studi               String?
  nama_sekolah               String?
  kota_sekolah               String?
  status_kelulusan           StatusKelulusan?
  keterangan_pendidikan      String?
  kategori_pangkat_id        String?
  golongan_pangkat_id        String?
  sub_golongan_pangkat_id    String?
  no_dana_pensiun            String?
  nama_kontak_darurat_1      String?
  nomor_telepon_kontak_darurat_1 String?
  hubungan_kontak_darurat_1  String?
  alamat_kontak_darurat_1    String?
  nama_kontak_darurat_2      String?
  nomor_telepon_kontak_darurat_2 String?
  hubungan_kontak_darurat_2  String?
  alamat_kontak_darurat_2    String?
  point_of_original         String?
  point_of_hire             String?
  ukuran_seragam_kerja       String?
  ukuran_sepatu_kerja        String?
  lokasi_sebelumnya_id      String?
  tanggal_mutasi             DateTime?
  siklus_pembayaran_gaji     String?
  costing                   String?
  assign                    String?
  actual                    String?

  // Tab Informasi Keluarga
  tanggal_lahir_pasangan       DateTime?
  pendidikan_terakhir_pasangan String?
  keterangan_pasangan          String?
  nama_ayah_kandung           String?
  tanggal_lahir_ayah_kandung   DateTime?
  pendidikan_terakhir_ayah     String?
  pekerjaan_ayah               String?
  keterangan_ayah              String?
  nama_ibu_kandung            String?
  tanggal_lahir_ibu_kandung    DateTime?
  pendidikan_terakhir_ibu      String?
  pekerjaan_ibu                String?
  keterangan_ibu               String?
  anak_ke                     Int?
  jumlah_saudara_kandung       Int?
  nama_ayah_mertua            String?
  tanggal_lahir_ayah_mertua    DateTime?
  pendidikan_terakhir_ayah_mertua String?
  pekerjaan_ayah_mertua        String?
  keterangan_ayah_mertua       String?
  nama_ibu_mertua             String?
  tanggal_lahir_ibu_mertua     DateTime?
  pendidikan_terakhir_ibu_mertua String?
  pekerjaan_ibu_mertua         String?
  keterangan_ibu_mertua        String?

  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  // Relasi
  divisi              Divisi              @relation(fields: [divisi_id], references: [id])
  department          Department          @relation(fields: [department_id], references: [id])
  posisi_jabatan      PosisiJabatan       @relation(fields: [posisi_jabatan_id], references: [id])
  status_karyawan     StatusKaryawan      @relation(fields: [status_karyawan_id], references: [id])
  lokasi_kerja        LokasiKerja         @relation("LokasiKerja", fields: [lokasi_kerja_id], references: [id])
  lokasi_sebelumnya   LokasiKerja?        @relation("LokasiSebelumnya", fields: [lokasi_sebelumnya_id], references: [id])
  tag                 Tag?                @relation(fields: [tag_id], references: [id])
  jenis_hubungan_kerja JenisHubunganKerja? @relation(fields: [jenis_hubungan_kerja_id], references: [id])
  kategori_pangkat    KategoriPangkat?    @relation(fields: [kategori_pangkat_id], references: [id])
  golongan_pangkat    Golongan?           @relation(fields: [golongan_pangkat_id], references: [id])
  sub_golongan_pangkat SubGolongan?       @relation(fields: [sub_golongan_pangkat_id], references: [id])

  manager             Karyawan?           @relation("Manager", fields: [manager_id], references: [id])
  bawahan_manager     Karyawan[]          @relation("Manager")
  atasan_langsung     Karyawan?           @relation("AtasanLangsung", fields: [atasan_langsung_id], references: [id])
  bawahan_atasan      Karyawan[]          @relation("AtasanLangsung")

  anak                Anak[]
  saudara_kandung     SaudaraKandung[]
  user                User?

  @@map("karyawan")
}

model Anak {
  id            String       @id @default(uuid())
  karyawan_id   String
  nama_anak     String
  jenis_kelamin JenisKelamin?
  tanggal_lahir DateTime?
  keterangan    String?
  created_at    DateTime     @default(now())
  updated_at    DateTime     @updatedAt

  karyawan Karyawan @relation(fields: [karyawan_id], references: [id], onDelete: Cascade)

  @@map("anak")
}

model SaudaraKandung {
  id                    String       @id @default(uuid())
  karyawan_id           String
  nama_saudara_kandung  String
  jenis_kelamin         JenisKelamin?
  tanggal_lahir         DateTime?
  pendidikan_terakhir  String?
  pekerjaan             String?
  keterangan            String?
  created_at            DateTime     @default(now())
  updated_at            DateTime     @updatedAt

  karyawan Karyawan @relation(fields: [karyawan_id], references: [id], onDelete: Cascade)

  @@map("saudara_kandung")
}
